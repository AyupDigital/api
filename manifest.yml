---
defaults: &defaults
  buildpack: php_buildpack
  services:
  - hys-db
  - hys-redis
  - hys-search

applications:
- name: helpyourselfsutton-api
  <<: *defaults
  memory: 256M
  instances: ((instances))
  routes:
  - route: ((route))

- name: helpyourselfsutton-queue-worker
  <<: *defaults
  instances: 1
  memory: 128M
  no-route: true
  command: php artisan queue:work --queue=default,search,notifications --tries=1
  health-check-type: process

- name: helpyourselfsutton-scheduler
  <<: *defaults
  instances: 1
  memory: 128M
  no-route: true
  command: php artisan ck:run-scheduler
  health-check-type: process
